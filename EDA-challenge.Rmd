---
title: "EDA-challenge"
author: "Matt Ming"
date: "2/7/2022"
output: html_document
---

# Preliminaries

First, to get the packages needed for this assignment:

```{r}
library(tidyverse)
library(dplyr)
```

Next, to load in the data from the url provided in the assignment:

```{r}
f <- "https://raw.githubusercontent.com/difiore/ada-2022-datasets/main/data-wrangling.csv"
d <- read_csv(f, col_names = TRUE)
names(d)
```

# Assignment

## 1 - 3

Now, we will create some new variables:

BSD (Body Size Dimorphism) = Ratio of avg male mass ("Body_mass_male_mean") to 
avg female mass ("Body_mass_female_mean")

sex_ratio = Ratio of number of Adult Males ("AdultMales") to Adult Females 
("AdultFemale") in a typical group

DI (Defensibility Index) = Ratio of day range length ("DayLength_km") to 
diameter of home range (r = sqrt("HomeRange_km2"/pi))

```{r}
d$BSD <- d$Body_mass_male_mean/d$Body_mass_female_mean
d$sex_ratio <- d$AdultFemale/d$AdultMales
d$DI <- d$DayLength_km/(sqrt(d$HomeRange_km2/pi))
```

## 4

Generating and analyzing plots for Day Range Length ("DayLength_km") vs Time 
Moving ("Move"):

```{r}
p1 <- ggplot(d,aes(x = Move,y = log(DayLength_km))) + 
  ylab("log(Day Range Length) (km)") + xlab("Time Spent Moving (hr)") +
  geom_point(na.rm = TRUE)
p1
p1 <- p1 + aes(color = factor(Family)) + facet_wrap(~Family,ncol = 4) +
  theme(legend.position = "none")
p1
```

Based on the plot above, there seems to be a loose positive correlation between 
time spent moving and distance traveled.  This correlation is recapitulated in 
the Atelidae Hylobatidae families, and weakly in the Cercopithecidae family, but 
this trend does not appear to hold with the other families for which there is 
data.  Because of the range of values in Range Length, this field was 
transformed to a log scale for more consistent grouping of points.

## 5

Generating and analyzing plots for Day Range Length ("DayLength_km") vs Group
Size ("MeanGroupSize"):

```{r}
p2 <- ggplot(d,aes(x = log(MeanGroupSize),y = log(DayLength_km))) + 
  ylab("Day Range Length (km)") + xlab("Mean Group Size (individuals)") +
  geom_point(na.rm = TRUE)
p2
p2 <- p2 + aes(color = factor(Family)) + facet_wrap(~Family,ncol = 4) +
  theme(legend.position = "none")
p2
```

Based on the plot above, there seems to be a loose positive correlation between 
species average group size and distance traveled.  This correlation is more 
strongly seen in family-level data, specifically for the Atelidae, Cebidae, 
Cercopithecidae, Hominidae, Indriidae, and Pitheciidae families; the Lemuridae 
family showed not much of a correlation between these variables, while 
Hylobatidae actually showed a negative correlation.  Because of the range of 
values in both Range Length and Mean Group Size, both of these fields were 
transformed to a log scale for more consistent grouping of points.

## 6

Generating and analyzing plots for Body Size Dimorphism ("BSD") vs Canine Size
Dimorphism ("Canine_Dimorphism"):

```{r}
p3 <- ggplot(d,aes(x = log(BSD),y = log(Canine_Dimorphism))) + 
  ylab("Body Size Dimorphism") + xlab("Canine Size Dimorphism") +
  geom_point(na.rm = TRUE)
p3
p3 <- p3 + aes(color = factor(Family)) + facet_wrap(~Family,ncol = 4) +
  theme(legend.position = "none")
p3
```

Based on the plot above, there seems to be a loose positive correlation between
Body Size Dimorphism and Canine Size Dimorphism.  Interestingly, this pattern
is not really seen very strongly on an Individual family basis, except in 
Cebidae; there is also a slight positive correlation in Cercopithecidae, 
Galagidae, Hominidae, Hylobatidae, Lorisidae, and Pitheciidae.

## 7

Create a new variable called diet_strategy which has labels

-"frugivore" if fruits make up more than 50% of diet

-"folivore" if leaves make up more than 50% of diet

-"omnivore" if neither of the above is true

```{r}
d <- mutate(d, "diet_strategy" = ifelse(
  d$Fruit >= 50,"frugivore",
  ifelse(as.numeric(d$Leaves) >= 50,"folivore","omnivore")
))
boxplot(d$MeanGroupSize~d$diet_strategy)
```

Based on the above boxplot, it seems that the average group size of frugivores
is no bigger than the average group size of folivores, but the largest frugivore
groups are larger than the largest folivore groups.

## 8

Now, adding a variable "Binomial" to the dataframe d, which is a concatenation
of Genus ("Genus") and Species ("Species")

Trimming the dataframe to only include the variables "Binomial", "Family",
"Brain_size_species_mean", and "Body_mass_male_mean"

Grouping the variables by "Family"

Calculating the average Brain Size and Male Body Mass per Family

Finally, arranging by increasing brain size

```{r}
d %>% mutate(Binomial = paste(d$Genus,d$Species)) %>% 
  select(Binomial,Family,Brain_Size_Species_Mean,Body_mass_male_mean) %>%
  group_by(Family) %>% summarise(
    Brain_size_species_mean = mean(Brain_Size_Species_Mean,na.rm = TRUE),
    Body_mass_male_mean = mean(Body_mass_male_mean,na.rm = TRUE)) %>%
  arrange(Brain_size_species_mean)
```